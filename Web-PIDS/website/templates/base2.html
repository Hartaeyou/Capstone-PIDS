<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Passenger Information System</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style/style.css') }}">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='img/KaiIcon.png') }}">

</head>

<body>
  <div class="container-fluid">
    <div class="row">
      <section class="col-md-7" id="leftSide">
        <h1 class="text-center fw-bold p-5">Passenger Information System</h1>
        <div class="row mt-3" id="cardContainer">
          <!-- card tentang informasi kereta -->
          <div class="col-md-6">
            <div class="card w-100 trainInformation">
              <div class="card-body" style="height: 175px">
                <h5 class="card-title fw-normal" style="font-size:25px">Anda Menaiki Kereta:</h5>
                {% if data %}
                <p class="fw-bold text-center" style="font-size: 44px;">{{ data['data']['nama_kereta'] }}</p>
                <p class="fw-semibold text-center" style="font-size: 37px; margin-top: -1.55rem;">{{ data['data']['kode_kereta'] }}</p>
                {% else %}
                <p class="fw-bold text-center" style="font-size: 44px;">Kereta tidak ditemukan</p>
                {% endif %}
              </div>
            </div>
          </div>
          <!-- end card tentang informasi kereta -->

          <!-- card tentang tanggal sekarang -->
          <div class="col-md-6">
            <div class="card w-100 timeNow" style="height: 175px">
              <div class="card-body">
                <h2 id="nowTime" class="text-center fw-bold p-2" style="font-size: 66px">15.00</h2>
                <p id="nowDate" class="text-center fw-semibold" style="font-size: 25px; margin-top: -1.55rem;">Selasa, 20 November 2023</p>
              </div>
            </div>
          </div>
          <!-- end card tentang tanggal sekarang -->

          <!-- card tentang distance -->
          <div class="col-md-12 mt-3">
            <div class="card w-100 nextStation">
              <div class="card-body" style="height: 355px; padding: 2rem">
                <p class="card-text fw-normal" style="font-size: 51px;">Stasiun Selanjutnya</p>
                <p class="card-text fw-bold" style="font-size: 64px;">STASIUN RAWA BUAYA</p>
                <p class="card-text fw-semibold" style="font-size: 58px;">12Km</p>
              </div>
            </div>
          </div>
          <!-- end card tentang distance -->
        </div>
      </section>

      <section class="col-md-5" id="rightSide">
        <div class="d-flex justify-content-end p-4">
          <img src="{{ url_for('static', filename='img/KaiIcon.png') }}" width="100rem" alt="">
        </div>
        <div class="station-timeline">
          <div class="d-flex justify-content-center align-items-center">
            {% if data['data']['rute'] and data['data']['rute']['points'] %}
              <ul class="timeline" id="station-timeline">
                  {% set index = 0 %}
                  {% for point in data['data']['rute']['points'] %}
                  <li class="timeline-item current">
                      <div class="circle">{{ loop.index }}</div>
                      <div class="station-name fw-bold"><span class="fw-normal">Stasiun</span> <br> {{ point['nama'] }}</div>
                  </li>
                  {% set index = index + 1 %}
                  {% endfor %}
              </ul>
              {% else %}
              <p class="fw-bold text-center" style="font-size: 44px;">Rute Belum Di Atur <br> Silahkan Hubungi Admin</p>
              {% endif %}
          </div>
      </div>
      </div>

      </section>
    </div>

</body>
<script src="{{ url_for('static', filename='js/script.js') }}"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<script>
  let currentIndex = 0;
  let isAscending = true; // Variabel untuk menentukan arah

  const stationsData = {{ data['data']['rute']['points']|tojson }};
  let stations = [...stationsData]; // Salin data stasiun agar mudah dimodifikasi

  function updateStations() {
      const stationTimeline = document.getElementById("station-timeline");
      stationTimeline.innerHTML = ""; // Reset isi timeline

      // Tambahkan stasiun ke timeline
      stations.forEach((station, index) => {
          const li = document.createElement("li");
          li.className = "timeline-item";
          if (index === currentIndex) {
              li.classList.add("active");
          }
          li.innerHTML = `
              <div class="circle">${index + 1}</div>
              <div class="station-name fw-bold">
                  <span class="fw-normal">Stasiun</span><br>${station.nama}
              </div>
          `;
          stationTimeline.appendChild(li);
      });

      // Periksa apakah sudah mencapai stasiun terakhir atau pertama
      if (isAscending && currentIndex === stations.length - 1) {
          // Ubah ke descending dan mulai dari nomor 1
          stations = stations.reverse();
          currentIndex = 0; // Reset ke awal
          isAscending = false;
      } else if (!isAscending && currentIndex === stations.length - 1) {
          // Ubah ke ascending dan mulai dari nomor 1
          stations = stations.reverse();
          currentIndex = 0; // Reset ke awal
          isAscending = true;
      } else {
          // Update index untuk stasiun berikutnya
          currentIndex++;
      }
  }

  // Panggil fungsi updateStations setiap 10 detik
  setInterval(updateStations, 10000);

  // Jalankan fungsi pertama kali untuk inisialisasi
  updateStations();
</script>


</html>